
﻿(function(fireworks){fireworks.Firework=Firework;function Firework(startX,startY,targetX,targetY){this.x=startX;this.y=startY;this.startX=startX;this.startY=startY;this.targetX=targetX;this.targetY=targetY;this.distanceToTarget=fireworks.calculateDistance(startX,startY,targetX,targetY);this.distanceTraveled=0;this.coordinates=[];this.coordinateCount=fireworks.options.fireworkTrailLength;while(this.coordinateCount--){this.coordinates.push([this.x,this.y]);}
this.angle=Math.atan2(targetY-startY,targetX-startX);this.speed=fireworks.options.fireworkSpeed;this.acceleration=fireworks.options.fireworkAcceleration;this.brightness=fireworks.random(fireworks.options.fireworkBrightnessRange[0],fireworks.options.fireworkBrightnessRange[1]);this.targetRadius=1;}
Firework.prototype.update=function(index){this.coordinates.pop();this.coordinates.unshift([this.x,this.y]);if(this.targetRadius<fireworks.options.fireworkTargetRadius){this.targetRadius+=0.3;}else{this.targetRadius=1;}
this.speed*=this.acceleration;var velocityX=Math.cos(this.angle)*this.speed;var velocityY=Math.sin(this.angle)*this.speed;this.distanceTraveled=fireworks.calculateDistance(this.startX,this.startY,this.x+velocityX,this.y+velocityY);if(this.distanceTraveled>this.distanceToTarget){fireworks.createParticles(this.targetX,this.targetY);fireworks.fireworks.splice(index,1);}else{this.x+=velocityX;this.y+=velocityY;}};Firework.prototype.draw=function(){fireworks.ctx.beginPath();fireworks.ctx.moveTo(this.coordinates[this.coordinates.length-1][0],this.coordinates[this.coordinates.length-1][1]);fireworks.ctx.lineTo(this.x,this.y);fireworks.ctx.strokeStyle='hsl('+fireworks.options.hue+',100%,'+this.brightness+'%)';fireworks.ctx.lineWidth=fireworks.options.ctxLineWidth;if(fireworks.options.ctxShadow){fireworks.ctx.shadowColor='rgb(0, 0, 0)';fireworks.ctx.shadowOffsetX=15;fireworks.ctx.shadowOffsetY=15;}
else{fireworks.ctx.shadowColor=0;fireworks.ctx.shadowOffsetX=0;fireworks.ctx.shadowOffsetY=0;}
fireworks.ctx.stroke();if(fireworks.options.fireworkShowTarget){fireworks.ctx.beginPath();fireworks.ctx.arc(this.targetX,this.targetY,this.targetRadius,0,360*Math.PI/180);fireworks.ctx.stroke();}};})(window.Fireworks=window.Fireworks||{});﻿(function(fireworks){fireworks.Particle=Particle;function Particle(x,y){this.x=x;this.y=y;this.coordinates=[];this.coordinateCount=fireworks.options.particleTrailLength;while(this.coordinateCount--){this.coordinates.push([this.x,this.y]);}
this.angle=fireworks.random(0,360*Math.PI/180);this.speed=fireworks.random(fireworks.options.particleSpeedRange[0],fireworks.options.particleSpeedRange[1]);this.friction=fireworks.options.particleFriction;this.gravity=fireworks.options.particleGravity;this.hue=fireworks.random(fireworks.options.hue-fireworks.options.particleHueRange[0],fireworks.options.hue+fireworks.options.particleHueRange[1]);this.brightness=fireworks.random(fireworks.options.particleBrightnessRange[0],fireworks.options.particleBrightnessRange[1]);this.alpha=fireworks.options.particleAlpha;this.decay=fireworks.random(fireworks.options.particleDecayRange[0],fireworks.options.particleDecayRange[1]);}
Particle.prototype.update=function(index){this.coordinates.pop();this.coordinates.unshift([this.x,this.y]);this.speed*=this.friction;this.x+=Math.cos(this.angle)*this.speed;this.y+=Math.sin(this.angle)*this.speed+this.gravity;this.alpha-=this.decay;if(this.alpha<=this.decay){fireworks.particles.splice(index,1);}};Particle.prototype.draw=function(){fireworks.ctx.beginPath();fireworks.ctx.moveTo(this.coordinates[this.coordinates.length-1][0],this.coordinates[this.coordinates.length-1][1]);fireworks.ctx.lineTo(this.x,this.y);fireworks.ctx.strokeStyle='hsla('+this.hue+', 100%, '+this.brightness+'%, '+this.alpha+')';fireworks.ctx.stroke();};})(window.Fireworks=window.Fireworks||{});﻿(function(fireworks){fireworks.greeting=greeting;var svg=null;var width=null;var height=null;var greetingTitle=null;var greetingTitleX=null;var greetingTitleY=null;var greetingSubtitle=null;var greetingSubtitleX=null;var greetingSubtitleY=null;var greetingTitleColor="#aaaf18";var greetingSubtitleColor="lightblue";var font={family:"Verdana",weight:"bold",size:34};var animationDirection=2;var textAnimationSpeed=30;var animationCounter=null;var maxFontSize=72;var minFontSize=32;var textElementTitle=null;var textElementSubtitle=null;var animationID=null;function greeting(){if(!fireworks.options.greeting){return;}
animationCounter=130;svg=fireworks.svg;width=fireworks.canvasWidth;height=fireworks.canvasHeight;greetingTitle=fireworks.options.greetingTitle;greetingSubtitle=fireworks.options.greetingSubtitle;var greetingTitleLength=getTextLength(greetingTitle);greetingTitleX=getXCoordinate(greetingTitleLength);greetingTitleY=getYCoordinate(2);var greetingSubtitleLength=getTextLength(greetingSubtitle);greetingSubtitleX=getXCoordinate(greetingSubtitleLength);greetingSubtitleY=getYCoordinate(1);textElementTitle=createTextElement(greetingTitleX,greetingTitleY,greetingTitle,greetingTitleColor,font);svg.appendChild(textElementTitle);textElementSubtitle=createTextElement(greetingSubtitleX,greetingSubtitleY,greetingSubtitle,greetingSubtitleColor,font);svg.appendChild(textElementSubtitle);var fontCopy={family:font.family,weight:font.weight,size:font.size};animationID=setInterval(function(){animateText.call(fontCopy);},textAnimationSpeed);}
function createMultilineText(textElement,text,coordinateX,coordinateY,size){var words=text.split(' ');var word=words.shift();var newTSElement=createSvgNSTag("tspan");var textNode=document.createTextNode(word+" ");var tSpanElement=newTSElement.cloneNode(true);tSpanElement.setAttribute('x',coordinateX);tSpanElement.setAttribute('y',coordinateY);tSpanElement.appendChild(textNode);textElement.appendChild(tSpanElement);coordinateY+=size;while(words.length>0){word=words.shift();console.log(textNode.data.length);textNode=document.createTextNode(word+" ");if(tSpanElement.innerHTML.length+word.length+size/20>width/35){tSpanElement.setAttribute('x',coordinateX);tSpanElement.setAttribute('y',coordinateY);coordinateY+=size;textElement.appendChild(tSpanElement);tSpanElement=newTSElement.cloneNode(true);}
tSpanElement.appendChild(textNode);}
textElement.appendChild(tSpanElement);}
function createTextElement(coordinateX,coordinateY,text,fill,font){var textElementTitle,strokeColor='black',strokeWidth=1;textElementTitle=createSvgNSTag('text');createMultilineText(textElementTitle,text,coordinateX,coordinateY,font.size);textElementTitle.setAttribute('x',coordinateX);textElementTitle.setAttribute('y',coordinateY);textElementTitle.setAttribute('fill',fill);textElementTitle.setAttribute('font-size',font.size);textElementTitle.setAttribute('font-weight',font.weight);textElementTitle.setAttribute('font-family',font.family);textElementTitle.setAttribute('stroke',strokeColor);textElementTitle.setAttribute('stroke-width',strokeWidth);return textElementTitle;}
function animateText(){if(animationCounter>0){if(animationDirection>0){if(this.size<maxFontSize){this.size+=animationDirection;}
else{animationDirection=-animationDirection;}}
else{if(this.size>minFontSize){this.size+=animationDirection;}
else{animationDirection=-animationDirection;}}
textElementTitle.parentNode.removeChild(textElementTitle);animationCounter--;var greetingTitleLength=getTextLength(greetingTitle,this.size);greetingTitleX=getXCoordinate(greetingTitleLength);textElementTitle=createTextElement(greetingTitleX,greetingTitleY,greetingTitle,getRandomColor(),this);svg.appendChild(textElementTitle);}
else{svg.innerHTML="";clearInterval(animationID);}}
function getXCoordinate(textLength){return(width/2)-(textLength/2);}
function getYCoordinate(linePosition){var center=height/2;for(;linePosition>0;linePosition--){center-=80;}
return center;}
function getTextLength(text,fontSize){var textWidth=null;var span=document.createElement("span");span.style.visibility="hidden";span.style.fontSize=(fontSize||font.size)+"px";span.style.fontWeight=font.weight;span.style.fontFamily=font.family;span.innerText=text;document.body.appendChild(span);textWidth=span.clientWidth||span.offsetWidth;document.body.removeChild(span);return textWidth;}
function getRandomColor(){var red=Math.floor(Math.random()*256),green=Math.floor(Math.random()*256),blue=Math.floor(Math.random()*256);return'rgb('+red+','+green+','+blue+')';}
function createSvgNSTag(tagName){return document.createElementNS('http://www.w3.org/2000/svg',tagName);}})(window.Fireworks=window.Fireworks||{});﻿(function(fireworks){fireworks.Options=Options;function Options(options){if(options===undefined){options={};}
if(options.width!==undefined){if(options.width<0){options.width=fireworks.canvasWidth+options.width+20;}
this.width=options.width;fireworks.canvasWidth=options.width;fireworks.canvas.width=options.width;fireworks.svg.style.width=options.width;}
if(options.height!==undefined){if(options.height<0){options.height=fireworks.canvasHeight+options.height;}
this.height=options.height;fireworks.canvasHeight=options.height;fireworks.canvas.height=options.height;fireworks.svg.style.height=options.height;}
this.timerTotal=options.timerTotal||70;this.hue=options.hue||180;this.hueStep=options.hueStep||0.5;this.ctxFillStyle=options.ctxFillStyle||'rgba(0,0,0,0.4)';this.ctxLineWidth=options.ctxLineWidth||2;this.ctxShadow=options.ctxShadow===undefined?true:options.ctxShadow;this.fireworkTrailLength=options.fireworkTrailLength||3;this.fireworkSpeed=options.fireworkSpeed||2;this.fireworkAcceleration=options.fireworkAcceleration||1.05;this.fireworkBrightnessRange=options.fireworkBrightnessRange||[50,80];this.fireworkTargetRadius=options.fireworkTargetRadius||5;this.fireworkShowTarget=options.fireworkShowTarget===undefined?true:options.fireworkShowTarget;this.particleTrailLength=options.particleTrailLength||5;this.particleCount=options.particleCount||30;this.particleSpeedRange=options.particleSpeedRange||[1,10];this.particleFriction=options.particleFriction||0.95;this.particleGravity=options.particleGravity||1;this.particleHueRange=options.particleHueRange||[15,15];this.particleBrightnessRange=options.particleBrightnessRange||[50,80];this.particleAlpha=options.particleAlpha||1;this.particleDecayRange=options.particleDecayRange||[0.015,0.03];this.greetingTitle=options.greetingTitle||"Merry Christmas";this.greetingSubtitle=options.greetingSubtitle||"and Happy New Year!";this.greeting=options.greeting===undefined?false:options.greeting;}})(window.Fireworks=window.Fireworks||{});﻿(function(fireworks,window){window.requestAnimationFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60);};})();fireworks.canvas=document.createElement("canvas");fireworks.canvas.id="fireworks-field";setPositionAndAppendToDocument(fireworks.canvas);fireworks.svg=document.createElementNS("http://www.w3.org/2000/svg","svg");fireworks.svg.id="the-svg";setPositionAndAppendToDocument(fireworks.svg);fireworks.ctx=fireworks.canvas.getContext('2d');setWidthAndHeight();fireworks.options=new fireworks.Options();fireworks.fireworks=[];fireworks.particles=[];fireworks.random=function random(min,max){return Math.random()*(max-min)+min;};fireworks.calculateDistance=function calculateDistance(point1X,point1Y,point2X,point2Y){var distanceX=point1X-point2X;var distanceY=point1Y-point2Y;return Math.sqrt(Math.pow(distanceX,2)+Math.pow(distanceY,2));};fireworks.createParticles=function createParticles(x,y){var particleCount=fireworks.options.particleCount;while(particleCount--){fireworks.particles.push(new fireworks.Particle(x,y));}};var timerTick=0;var fireworksStarted=false;fireworks.init=function loop(options){if(options!==null){fireworks.options=new fireworks.Options(options);}
if(!fireworksStarted&&fireworks.options.greeting){fireworks.greeting();fireworks.options.greeting=false;}
window.requestAnimationFrame(loop.bind(null,null));fireworks.options.hue+=fireworks.options.hueStep;fireworks.ctx.globalCompositeOperation='destination-out';fireworks.ctx.fillStyle=fireworks.options.ctxFillStyle;fireworks.ctx.fillRect(0,0,fireworks.canvasWidth,fireworks.canvasHeight);fireworks.ctx.globalCompositeOperation='lighter';var fireworkIndex=fireworks.fireworks.length;while(fireworkIndex--){fireworks.fireworks[fireworkIndex].draw();fireworks.fireworks[fireworkIndex].update(fireworkIndex);}
var particleIndex=fireworks.particles.length;while(particleIndex--){fireworks.particles[particleIndex].draw();fireworks.particles[particleIndex].update(particleIndex);}
if(timerTick>=fireworks.options.timerTotal){fireworks.fireworks.push(new fireworks.Firework(fireworks.canvasWidth/2,fireworks.canvasHeight,fireworks.random(0,fireworks.canvasWidth),fireworks.random(0,fireworks.canvasHeight/2)));timerTick=0;}else{timerTick++;}
fireworksStarted=true;};window.onresize=function(){setWidthAndHeight();};function setWidthAndHeight(){var docElement=window.document.documentElement,body=window.document.getElementsByTagName('body')[0],width=window.innerWidth||docElement.clientWidth||body.clientWidth,height=window.innerHeight||docElement.clientHeight||body.clientHeight;if(fireworks.options!==undefined){fireworks.options.width=width;fireworks.options.height=height;}
fireworks.canvas.width=width;fireworks.canvas.height=height;fireworks.svg.style.width=width;fireworks.svg.style.height=height;fireworks.canvasWidth=width;fireworks.canvasHeight=height;}
function setPositionAndAppendToDocument(element){element.style.position="fixed";element.style.top=0;element.style.left=0;element.style.zIndex=100000;element.style.pointerEvents="none";window.document.body.appendChild(element);}})(window.Fireworks=window.Fireworks||{},window);